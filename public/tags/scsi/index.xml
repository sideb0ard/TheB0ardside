<?xml version="1.0" encoding="utf-8" standalone="yes" ?>
<rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom">
  <channel>
      <title>Scsi on The B0ardside </title>
    <link>http://127.0.0.1:1313/tags/scsi/index.xml</link>
    <language>en-us</language>
    <author>Thorsten Sideb0ard</author>
    <rights>Copyleft (c) 1974 - The Future, Thorsten Sideb0ard; nae rights reserved.</rights>
    <updated>2011-10-27 00:00:00 &#43;0000 UTC</updated>
    
    <item>
      <title>the mysterious MegaCLI</title>
      <link>http://127.0.0.1:1313/themysteriousmegacli</link>
      <pubDate>Thu, 27 Oct 2011 00:00:00 UTC</pubDate>
      <author>Thorsten Sideb0ard</author>
      <guid>http://127.0.0.1:1313/themysteriousmegacli</guid>
      <description>&lt;p&gt;I&#39;ve inherited some Production Sun Fire X4470 boxes, which upon first look appeared to only have 2 x 140GB drives. Checking the purchase orders however, revealed that they should in fact have 4 x 140GB drives, a fact confirmed by &amp;#8220;dmesg |grep scsi&amp;#8221;.&lt;/p&gt;&lt;p&gt;These Sun Fire servers come with an internal 6Gb SAS PCIe RAID HBA which are managed via the LSI MegaRAID Management Suite. Unfortunately, the LSI website is a nightmare to navigate and has been re-arranged with no-redirects, requires a login and in general makes it very hard to find and download the MegaCLI utility.&lt;br /&gt;I eventually found a working download link at &lt;a href=&#34;http://www.lsi.com/downloads/Public/MegaRAID%20Common%20Files/8.02.16_MegaCLI.zip&#34;&gt;http://www.lsi.com/downloads/Public/MegaRAID%20Common%20Files/8.02.16_MegaCLI.zip&lt;/a&gt;.&lt;/p&gt;&lt;p&gt;The zip file contains an RPM file, so if like myself, you run Debian, you&#39;ll need to run:&lt;br /&gt;&lt;strong&gt;rpm2cpio MegaCli-8.02.16-1.i386.rpm  | cpio -idmv&lt;/strong&gt;&lt;br /&gt;The binaries are statically compiled so actually run fine.&lt;/p&gt;&lt;p&gt;In this situation, it simply turned out my drives were setup as RAID 1 mirrors, which was easy to discern using:&lt;/p&gt;&lt;p&gt;&lt;strong&gt;./MegaCli64 -CfgDsply -aALL &lt;/strong&gt;&lt;/p&gt;&lt;p&gt;I came across a couple of good cheat sheets for MegaCLI -&lt;br /&gt;&lt;a href=&#34;http://thatlinuxbox.com/blog/article.php/lsi-megaraid-megacli&#34;&gt;http://thatlinuxbox.com/blog/article.php/lsi-megaraid-megacli&lt;/a&gt;&lt;br /&gt;&lt;a href=&#34;http://www.theserve.co.uk/web-hosting-blog/megacli-commands&#34;&gt;http://www.theserve.co.uk/web-hosting-blog/megacli-commands&lt;/a&gt;&lt;br /&gt;&lt;a href=&#34;http://ftzdomino.blogspot.com/2009/03/some-useful-megacli-commands.html&#34;&gt;http://ftzdomino.blogspot.com/2009/03/some-useful-megacli-commands.html&lt;/a&gt;&lt;br /&gt;&lt;a href=&#34;http://tools.rapidsoft.de/perc/perc-cheat-sheet.html&#34;&gt;http://tools.rapidsoft.de/perc/perc-cheat-sheet.html&lt;/a&gt;&lt;br /&gt;&lt;a href=&#34;http://www.5dollarwhitebox.org/drupal/node/82&#34;&gt;http://www.5dollarwhitebox.org/drupal/node/82&lt;/a&gt;&lt;/p&gt;&lt;p&gt;For me, the most useful ones were:&lt;/p&gt;&lt;p&gt;#Physical Disk List&lt;br /&gt;&lt;strong&gt;./MegaCli64 -PDList -aALL&lt;/strong&gt;&lt;/p&gt;&lt;p&gt;#Physical Drive Info&lt;br /&gt;&lt;strong&gt;./MegaCli64 -pdInfo -PhysDrv \[252:4\] -aALL |less&lt;/strong&gt;&lt;/p&gt;&lt;p&gt;#Logical Disk Info&lt;br /&gt;&lt;strong&gt;./MegaCli64  -LDInfo -LAll -aAll | less&lt;/strong&gt;&lt;/p&gt;&lt;p&gt;# Config Display&lt;br /&gt;&lt;strong&gt;./MegaCli64 -CfgDsply -aALL &lt;/strong&gt;&lt;/p&gt;&lt;p&gt;# Config add Logical Drive&lt;br /&gt;&lt;strong&gt;./MegaCli64  -CfgLdAdd -r0 \[252:4,252:5\] -a0&lt;/strong&gt;&lt;/p&gt;&lt;p&gt;# Logical Drive Init&lt;br /&gt;&lt;strong&gt;./MegaCli64 -LDInit -Start -L2 -a0&lt;/strong&gt;&lt;/p&gt;&lt;p&gt;We installed another two drives in the machine, which i was able to bring online in a RAID 0 volume using:&lt;br /&gt;&lt;strong&gt;./MegaCli64  -CfgLdAdd -r0 \[252:4,252:5\] -a0&lt;/strong&gt; &lt;/p&gt;&lt;p&gt;However, even after having created this RAID 0 volume, my OS couldn&#39;t see it when using &amp;#8216;&lt;strong&gt;fdisk -l&lt;/strong&gt;&amp;#8216; - i had to run&lt;br /&gt;&lt;strong&gt;echo &amp;#8220;- - -&amp;#8221; &gt; /sys/class/scsi_host/host0/scan &lt;/strong&gt;&lt;br /&gt;which forces a SCSI bus rescan, and made available the new drive.&lt;/p&gt;
</description>
    </item>
    
  </channel>
</rss>
