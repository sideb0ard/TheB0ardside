<!DOCTYPE html>
<html class="no-js" lang="en-US" prefix="og: http://ogp.me/ns# fb: http://ogp.me/ns/fb#">
<head>
    <meta charset="utf-8">

    <base href="http://theb0ardside.com">
    <title> TheB0ardside.com </title>
    <link rel="canonical" href="http://theb0ardside.com/tags/howto/">
    <link href="/static/css/b0ardstrap.min.css" rel="stylesheet"/>
    <link href="/static/css/b0ardstyle.css" rel="stylesheet"/>

    <link rel="alternate" type="application/rss+xml" title="RSS" href="http://theb0ardside.com/index.xml" />

</head>
<body lang="en">
<nav class="navbar navbar-inverse navbar-fixed-top" role="navigation">
  
  <div class="navbar-blah">
  <div class="navbar-header">
    <a class="navbar-brand" href="/">The B0ardside_</a>
  </div>

  <div>
    <ul class="nav navbar-nav navbar-right">
      <li class="dropdown">
        <a href="#" class="dropdown-toggle" data-toggle="dropdown">hello<b class="caret"></b></a>
        <ul class="dropdown-menu">
            <li><img src="/static/img/thor.jpg"></li>
            <li><a target="new" href="/categories/blog/">All Articles</a></li>
            <li><a target="new" href="mailto:thorsten@theb0ardside.com?subject=hullo">Email</a></li>
            <li><a target="new" href="http://github.com/sideb0ard">Code</a></li>
            <li><a target="new" href="http://drawingb0ard.blogspot.com/">Drawings</a></li>
            <li><a target="new" href="http://bff.fm/shows/highpoint-lowlife">Radio Show</a></li>
            <li><a target="new" href="https://sideb0ard.bandcamp.com/">Music</a></li>
            <li><a target="new" href="http://twitter.com/sideb0ard">Twitter</a></li>
            <li><a target="new" href="http://theb0ardside.com/index.xml">Rss Feed</a></li>
        </ul>
      </li>
    </ul>
  </div>
</div>
</nav>

  <div class="container">
  <div id="page">


<section id="main">
  <div>
   <h1 id="title">Howto</h1>
    
        <article class="post">
    <header>
      <h2><a href='http://theb0ardside.com/monolake-granular/'> Robert Henke Granulator</a> </h2>
      <div class="post-meta">Sun, Jul 16, 2017</div>
    </header>
    <p>Hmm, my <a href="https://github.com/sideb0ard/SBShell/blob/master/granulator.c">granular synth</a> hasn&rsquo;t quite come together yet, but I&rsquo;m learning a load.</p>

<p>This is a pretty informative (promo) video from Robert Henke/Monolake showcasing his <a href='https://www.ableton.com/en/packs/granulator-ii/'>&lsquo;Granulator&rsquo; plugin for Ableton Live.</a></p>

<p>If i can get mine to sound anything like that i&rsquo;ll be stoked!</p>

<div class="video-container">
<iframe width="560" height="315" src="//www.youtube.com/embed/9pn_b7OUO6I" frameborder="0" allowfullscreen></iframe>
</div>

</article>

    
        <article class="post">
    <header>
      <h2><a href='http://theb0ardside.com/let-vim-do-the-typing/'> Let Vim do the typing</a> </h2>
      <div class="post-meta">Thu, Mar 9, 2017</div>
    </header>
    <p>Discovered lots of great vim talks - this one is neat:</p>

<div class="video-container">
<iframe width="560" height="315" src="//www.youtube.com/embed/3TX3kV3TICU" frameborder="0" allowfullscreen></iframe>
</div>

</article>

    
        <article class="post">
    <header>
      <h2><a href='http://theb0ardside.com/purple-rain/'> Daniel Schiffman - Purple Rain in Processing</a> </h2>
      <div class="post-meta">Thu, Jun 30, 2016</div>
    </header>
    <p>I was listening to the <a href="http://creativecodingpodcast.com/61-coding-rainbows-with-dan-shiffman/">Creative Coding podcast</a> with Daniel Shiffman the other day - One thing they discussed was Daniel&rsquo;s new Coding Challenges youtube series - this one to do a &lsquo;Purple Rain&rsquo; in Processing is really fun!</p>

<div class="video-container">
<iframe width="560" height="315" src="//www.youtube.com/embed/KkyIDI6rQJI" frameborder="0" allowfullscreen></iframe>
</div>

</article>

    
        <article class="post">
    <header>
      <h2><a href='http://theb0ardside.com/android-audio-performance/'> Android - High Performance Audio</a> </h2>
      <div class="post-meta">Wed, May 11, 2016</div>
    </header>
    <p>I&rsquo;m currently working on a Brillo audio component, which will require very low latency performance.
While searching for some tips and prior art, I came across this talk from Google I/O 2013. A bit older now, but provides an excellent overview of the problem domain and approaches to solving those issues..</p>

<div class="video-container">
<iframe width="560" height="315" src="//www.youtube.com/embed/d3kfEeMZ65c" frameborder="0" allowfullscreen></iframe>
</div>

</article>

    
        <article class="post">
    <header>
      <h2><a href='http://theb0ardside.com/libmill-floss-weekly/'> Libmill on Randal Schwartz&#39;s FLOSS Weekly show</a> </h2>
      <div class="post-meta">Mon, Oct 19, 2015</div>
    </header>
    <p>I&rsquo;m moving into a new job position soon involving way more code, working in C/C++. I&rsquo;ve just started watching this podcast series and it&rsquo;s excellent - this one in particular is super relevant, bringing one of the best features from Golang into C. I like the minimalism of the project, it seems very much in alignment with the philosophy behind <a href="//suckless.org">Suckless</a>. (There&rsquo;s a previous episode, speaking with Anselm R Garbe from suckless, i&rsquo;d also highly recommend..)</p>

<div class="video-container">
<a href="https://twit.tv/shows/floss-weekly/episodes/358?autostart=false"><img width="900" src="/static/img/floss-randall.png"></a>
</div>

</article>

    
        <article class="post">
    <header>
      <h2><a href='http://theb0ardside.com/andrewgerrandgouk2015/'> Andrew Gerrand talking at Go UK 2015 - stupid gopher tricks</a> </h2>
      <div class="post-meta">Sun, Oct 11, 2015</div>
    </header>
    <p>Hah, some awesome bits in here&hellip;</p>

<div class="video-container">
<iframe width="560" height="315" src="//www.youtube.com/embed/UECh7X07m6E" frameborder="0" allowfullscreen></iframe>
</div>

</article>

    
        <article class="post">
    <header>
      <h2><a href='http://theb0ardside.com/visualprogexec/'> Visualising Program Execution</a> </h2>
      <div class="post-meta">Mon, Sep 28, 2015</div>
    </header>
    <p>Super fun live demo of program tracing and visualisation from this years Strange Loop conf..</p>

<div class="video-container">
<iframe width="560" height="315" src="//www.youtube.com/embed/Ml6Dp3F4Inc" frameborder="0" allowfullscreen></iframe>
</div>

</article>

    
        <article class="post">
    <header>
      <h2><a href='http://theb0ardside.com/docker-filesystems/'> Docker Storage Drivers</a> </h2>
      <div class="post-meta">Fri, Jun 12, 2015</div>
    </header>
    <p>Super nice quick overview of the importance of Copy-On-Write filesystems to Docker, going into detail of the benefits and downsides to each of the CoW options - AuFS, BTRFS, ZFS, Overlayfs, Device Mapper - great stuff!</p>

<div class="video-container">
<iframe width="560" height="315" src="//www.youtube.com/embed/hk6wqNBLlxQ" frameborder="0" allowfullscreen></iframe>
</div>

</article>

    
        <article class="post">
    <header>
      <h2><a href='http://theb0ardside.com/how-to-debug-anything/'> How To Debug Anything</a> </h2>
      <div class="post-meta">Mon, Nov 10, 2014</div>
    </header>
    <p>Pretty decent talk on debugging methodology..</p>

<div class="video-container">
<iframe width="560" height="315" src="//www.youtube.com/embed/VV7b7fs4VI8" frameborder="0" allowfullscreen></iframe>
</div>

</article>

    
        <article class="post">
    <header>
      <h2><a href='http://theb0ardside.com/joschabach-ai/'> How to Build a Mind</a> </h2>
      <div class="post-meta">Sat, Sep 27, 2014</div>
    </header>
    <p>Hugely compelling talk by Joscha Bach covering history and possible futures of AI..</p>

<div class="video-container">
<iframe width="560" height="315" src="//www.youtube.com/embed/2o2xBOQeB7Q" frameborder="0" allowfullscreen></iframe>
</div>

<p>Found <a href="http://cognitive-ai.com/">here</a></p>

</article>

    
        <article class="post">
    <header>
      <h2><a href='http://theb0ardside.com/vpc-design/'> AWS VPC best practises</a> </h2>
      <div class="post-meta">Sat, Jul 26, 2014</div>
    </header>
    <p>Super detailed and practical VPC design best practises - very cool stuff..</p>

<div class="video-container">
<iframe width="560" height="315" src="//www.youtube.com/embed/YoX_frLHbEs" frameborder="0" allowfullscreen></iframe>
</div>

</article>

    
        <article class="post">
    <header>
      <h2><a href='http://theb0ardside.com/joshua-davis-beyond-play/'> Joshua Davis - Beyond Play</a> </h2>
      <div class="post-meta">Mon, Jan 6, 2014</div>
    </header>
    <p>Wow. just wow&hellip;</p>

<div class="video-container">
<iframe width="560" height="315" src="//www.youtube.com/embed/LJS4fBjdPM4" frameborder="0" allowfullscreen></iframe>
</div>

<p><br/>
<a href="https://twitter.com/tackyy">Tack</a> turned me onto this guy the other day - i love him! Artist/Skater/Hacker - whats not to love?!</p>

<p>This was following me and Tack&rsquo;s <a href="https://github.com/sideb0ard/Codetraxx">Codetraxx</a> project - which is working - we&rsquo;re making music and synchronized via RabbitMQ as we set out to do - however we&rsquo;ve hit a bit of a wall with the algorithmic math behind musical composition, so we&rsquo;ve decided to focus on some mathematical hack nights for a while. Another friend of mine, <a href="https://twitter.com/mattspendlove">Matt Spendlove</a>, had told me about <a href="http://natureofcode.com/book/">The Nature Of Code</a> which i&rsquo;ve been wanting to read, so I suggested we play with Processing - seems awesome already! So yeah, Codetraxx on hold for a while, and work on a couple of Processing projects for a while &hellip;</p>

</article>

    
        <article class="post">
    <header>
      <h2><a href='http://theb0ardside.com/gopresentation/'> Go Presentation</a> </h2>
      <div class="post-meta">Mon, Dec 30, 2013</div>
    </header>
    <p>More and more I&rsquo;ve been dabbling with Go, which, mainly due to Hacker News, i&rsquo;ve been reading so many good things about. The syntax is super easy to pick up, but the killer feature seems to be the concurrency primitives - the Go Functions and message passing Channels seem like a super tight, rock solid implementation of Hoare&rsquo;s Communicating Sequential Processes. The following video is a really succinct walk through of building a concurent multi-protocol chat application ala Chat Roulette..</p>

<div class="video-container">
<iframe src="//player.vimeo.com/video/53221560" width="500" height="281" frameborder="0" webkitallowfullscreen mozallowfullscreen allowfullscreen></iframe> <p><a href="http://vimeo.com/53221560">Go: code that grows with grace</a> from <a href="http://vimeo.com/user4280938">&Oslash;redev Conference</a> on <a href="https://vimeo.com">Vimeo</a>.</p>
</div>

</article>

    
        <article class="post">
    <header>
      <h2><a href='http://theb0ardside.com/brendangregglinuxperformance/'> Brendan Gregg, Linux Performance</a> </h2>
      <div class="post-meta">Wed, Jun 12, 2013</div>
    </header>
    <p>The always interesting Brendan Greg &#8212; </p><p><iframe width="590" height="332" src="http://www.youtube.com/embed/0yyorhl6IjM?feature=oembed" frameborder="0" allowfullscreen></iframe></p>

</article>

    
        <article class="post">
    <header>
      <h2><a href='http://theb0ardside.com/berkshelfthemissingpiece/'> Berkshelf - the missing piece</a> </h2>
      <div class="post-meta">Wed, May 29, 2013</div>
    </header>
    <p>If you've been following my past few posts, you've seen i was investigating how best to integrate the plethora of Chef testing tools that've been coming out &#8212; foodcritic, chefspec, test-kitchen, mini-test &#8212; and although not testing tools per se, Berkshelf and Vagrant are the other pieces of the puzzle&#8230; but how to fit them all together? What is the directory structure for keeping your Berkfile - at the top of the repo? Inside a cookbook directory? How many Vagrant files am I going to create here?</p><p>If, like myself, you weren't along at this year's ChefConf 2013, you may also have missed on a major conceptual shift that has happened. Instead of the all-inclusive Chef-repo design pattern, as implied by the OpsCode Chef Repo - https://github.com/opscode/chef-repo - which, when used with all the community cookbooks out there, creates a mess of forked, modified and sub-moduled cookbooks and recipes. </p><p>The conceptual shift away and now recommended way, is to treat each cookbook as a separate piece of software and to give it it's own git repo, keeping them separate from from your Chef-repo. This combined, with a distinction between Library and Application cookbooks, and then bundled together via Berkshelf, enables a much cleaner and modular way of working. When you accept this move, it's much easier to then fit all the testing pieces together as they all live within each separate cookbook/repo.</p><p><a href="https://github.com/RiotGames/berkshelf/issues/535" title="Berk Comment" target="_blank">This Comment Thread</a> was what really drew it together for me, and then to fully clarify this way of working, watch Jamie Winsor's ChefConf talk which is the original starting point:</p><p><iframe width="590" height="332" src="http://www.youtube.com/embed/hYt0E84kYUI?feature=oembed" frameborder="0" allowfullscreen></iframe></p>

</article>

    
        <article class="post">
    <header>
      <h2><a href='http://theb0ardside.com/mocheftesting/'> Mo&#39; Chef Testing</a> </h2>
      <div class="post-meta">Mon, May 27, 2013</div>
    </header>
    <p>Following on from my last post about Test Driven Chef, this latest Food Fight show is a great roundup of the current testing tools landscape -</p><p><iframe width="590" height="332" src="http://www.youtube.com/embed/DhcXXOIerIc?feature=oembed" frameborder="0" allowfullscreen></iframe></p>

</article>

    
        <article class="post">
    <header>
      <h2><a href='http://theb0ardside.com/testdrivenchef/'> Test-Driven Chef</a> </h2>
      <div class="post-meta">Wed, May 15, 2013</div>
    </header>
    <p>I'm looking to start using Test-Kitchen and Berkshelf, and basically trying to get my head round setting up a proper test driven Chef setup.</p><p>I found this video from last year to be quite a good introduction to some of the setup -</p><p><iframe width="590" height="332" src="http://www.youtube.com/embed/o2e0aZUAVGw?feature=oembed" frameborder="0" allowfullscreen></iframe></p>

</article>

    
        <article class="post">
    <header>
      <h2><a href='http://theb0ardside.com/netflixoss/'> Netflix OSS</a> </h2>
      <div class="post-meta">Sat, May 11, 2013</div>
    </header>
    <p>Found this to be a particularly good episode of The Food Fight show with Jeremy Edberg and Adrian Cockcroft talking about the Netflix tools and architecture:</p><p><iframe width="590" height="332" src="http://www.youtube.com/embed/A69uTnfQgB8?feature=oembed" frameborder="0" allowfullscreen></iframe></p>

</article>

    
        <article class="post">
    <header>
      <h2><a href='http://theb0ardside.com/etsyscalingvidfrom2011/'> Etsy Scaling vid from 2011</a> </h2>
      <div class="post-meta">Thu, Jan 17, 2013</div>
    </header>
    <p><iframe width="590" height="332" src="http://www.youtube.com/embed/eenrfm50mXw?feature=oembed" frameborder="0" allowfullscreen></iframe></p><p>All well accepted practices by now, but still a good watch.</p>

</article>

    
        <article class="post">
    <header>
      <h2><a href='http://theb0ardside.com/usenixlisa12/'> Usenix/Lisa 12</a> </h2>
      <div class="post-meta">Sun, Dec 16, 2012</div>
    </header>
    <p>Just got back from the Usenix/Lisa 12 conference in San Diego, and had a great time, super inspiring talks and content.</p><p>Highlight of the conference for me was Brendan Gregg speaking on Performance Analysis Methodologies - most of his talk was based upon a paper he just published in ACM - <a href="https://queue.acm.org/detail.cfm?id=2413037" title="ACM" target="_blank">Thinking Methodically About Performance</a>.</p><p>The talks haven't yet been published on the Usenix website, but Brendan's blog has a ton of great looking content and older talks including this one on Visualisations for Performance Analysis</p><p><iframe width="590" height="332" src="http://www.youtube.com/embed/ml-t-9g6Mjc?fs=1&#038;feature=oembed" frameborder="0" allowfullscreen></iframe></p>

</article>

    
        <article class="post">
    <header>
      <h2><a href='http://theb0ardside.com/perconatablechecksum/'> Percona Table Checksum</a> </h2>
      <div class="post-meta">Thu, Oct 11, 2012</div>
    </header>
    <p><iframe src="http://blip.tv/play/AYLoizwC.html?p=1" width="550" height="443" scrolling="no" class="iframe-class" frameborder="0"></iframe><p>I must admit MySQL replication is something I&rsquo;ve never felt too comfortable with - in most of my positions, I&rsquo;ve had the luxury of working with a full time DBA who would handle all database related work. In my current workplace we have three major pairs of database machines, and have been going through upgrading them all to Percona MySQL 5.5. As you&rsquo;d expect data integrity is of the highest importance, so discovering this Percona Table Checksum tool is a real life saver, providing an amazing tool for verifying and fixing any drift or problems with MySQL slaves.</p><p>I can&rsquo;t take any credit for these instructions or the trial and error in assembling them, as they were penned by my workmate, the awesome <a href="http://www.linkedin.com/pub/trystan-leftwich/12/19b/8a2" target="_blank">Trystan Leftwich</a> - these are his notes for use at our place, with some additional clarifications from myself from working through them.</p><p>First things first, grab <a href="http://www.percona.com/doc/percona-toolkit" title="PT" target="_blank">the Percona Toolkit</a> and install.</p><p>Now on the master DB do the following:</p><p><code>create database BLAH;</code></p><p>This will be the database you store your checksums, so something like <strong>pt_checksums</strong> will do.</p><p>Now on the master as the mysql user, run</p><p><code>pt-table-checksum &ndash;create-replicate &ndash;replicate [db_name].[table_name] &ndash;databases [comma_separated_list_of_databases_you_want_to_check] &ndash;empty-replicate-table &ndash;chunk-size=5000 localhost<br /></code></p><p>Where [db_name].[table_name] is the database you created before, and a table name you will be able to remember. </p><p>EG <strong>pt_checksums.myimportanttables_checksums</strong></p><p>(If you get a &#8220;can not connect to host: blah, this is ok, ignore)</p><p>Now, when this is complete, go to the slave DB. (ensure replication is up to date - if you have errors, just skip them to get it up to date)</p><p>Then run the following</p><p><code>connect [db_you_created_above];<br />select * from [table_name_you_created_above] where this_crc != master_crc;<br /></code></p><p>If this returns an empty set, Then your DB is in sync - go straight to Go, collect $200. </p><p>If not you will have to try and sync it -</p><p>Create a user with the following permissions (pretty much everything)  (Also it may not need all of these, but couldn&rsquo;t find what exactly it needed)</p><blockquote><p>GRANT SELECT, INSERT, UPDATE, DELETE, CREATE, DROP, RELOAD, SHUTDOWN, PROCESS, FILE, REFERENCES, INDEX, ALTER, SHOW DATABASES, SUPER, CREATE TEMPORARY TABLES, LOCK TABLES, EXECUTE, REPLICATION SLAVE, REPLICATION CLIENT</p></blockquote><p>You can create with:</p><p><code>create user &#039;pt_checksum_maint&#039;@&#039;%&#039; identified by &#039;blah&#039;;<br />GRANT SELECT, INSERT, UPDATE, DELETE, CREATE, DROP, RELOAD, SHUTDOWN, PROCESS, FILE, REFERENCES, INDEX, ALTER, SHOW DATABASES, SUPER, CREATE TEMPORARY TABLES, LOCK TABLES, EXECUTE, REPLICATION SLAVE, REPLICATION CLIENT on <em>.</em> to  &#039;pt_checksum_maint&#039;@&#039;%&#039;;<br /></code></p><p>Then, still on the master, run the following command</p><p><code>pt-table-sync &ndash;execute &ndash;replicate [db_name].[table_name] master_db_ip/hostname &ndash;user user_you_created_above &ndash;ask-pass &ndash;no-foreign-key-checks<br /></code></p><p>(At first I assumed this would be run on the slave to fix it up, however the man page for pt-table-checksum explains: </p><blockquote><p>it always makes the changes on the replication master, never the replication slave directly.  This is in general the only safe way to bring a replica back in sync with its master; changes to the replica are usually the source of the problems in the first place.  However, the changes it makes on the master should be no-op changes that set the data to their current values, and actually affect only the replica.</p></blockquote><p>)</p><p>Once this table sync has been run, re-run the pt-table-checksum command, then verify your results on the slave - should be good .</p></p>

</article>

    
        <article class="post">
    <header>
      <h2><a href='http://theb0ardside.com/perlparpparp/'> perl parp parp</a> </h2>
      <div class="post-meta">Sun, Sep 2, 2012</div>
    </header>
    <p>I updated the IP address for both my Name Servers tonite, and was monitoring to see how quickly the new addresses were propagating.  First stop was the exceptionally useful <a href="http://www.whatsmydns.net/ " title="What&#039;s My DNS?" target="_blank">Whats My DNS</a></p><p>At the host level I also wanted to track the incoming DNS queries using tcpdump. I could see them streaming into the new host, and visually you could see an obvious difference when viewing the output of the same command on the old host. I googled around for a timer utility which run a command for a given time, so i could quantify the difference. Perfect answer was <a href="http://stackoverflow.com/questions/601543/command-line-command-to-auto-kill-a-command-after-a-certain-amount-of-time" title="Stack Overflow" target="_blank">here</a>, a simple perl wrapper function.</p><p>Here's how to use it to run tcpdump command for sixty seconds, and count the packets seen:</p><p><small><code># doalarm () { perl -e &#039;alarm shift; exec @ARGV&#039; "$@"; }<br /># doalarm 60 tcpdump -u  -i eth0 port 53  -n  |wc -l<br />tcpdump: verbose output suppressed, use -v or -vv for full protocol decode<br />listening on eth0, link-type EN10MB (Ethernet), capture size 65535 bytes<br />19504</code></small></p>

</article>

    
        <article class="post">
    <header>
      <h2><a href='http://theb0ardside.com/tcpdumppatterns/'> tcpdump patterns</a> </h2>
      <div class="post-meta">Fri, Jun 29, 2012</div>
    </header>
    <p><img src="http://farm8.staticflickr.com/7185/6844034348_50dd1c5f32_b.jpg" alt="McCarthy" /></p><p>I use tcpdump a lot, but mostly at a reasonably high level, only really restricting the capture to host and port info, then pulling the dump back into Wireshark for nicer visualisation and easier filtering.</p><p>A couple of months back I read <a href="http://www.amazon.com/Moonwalking-Einstein-Science-Remembering-Everything/dp/159420229X" title="Moonwalking With Einstein" target="_blank">Moonwalking With Einsten</a>, which is a nice pop-science history of the importance of memory in previous societies, alongside the contemporary phenomena of <a href="http://www.worldmemorychampionships.com/" title="World Memory Competitions" target="_blank">competitive memory competitions</a>. The book is great, and explains how feats of memory are achieved via the technique of <a href="http://en.wikipedia.org/wiki/Method_of_loci" title="Memory Palaces" target="_blank">memory palaces</a>, a technique dating back to Roman times - spatial memory relationships. I've been using the technique a lot since I read this book, and truly, no magic to it, it really works. Basically, when you have a list of items to remember, you weave each item, in order, into a spatially focussed narrative.</p><p>So, last night, I get out my copy of TCP/IP Illustrated, Volume 1*, one of my most-returned-to tech books - I've always wanted to have a more encyclopedic knowledge of the lower level details of TCP/IP, and last night applied the Memory Palace Technique to the structure of a TCP packet.<br/>
(( read the <a href="http://en.wikipedia.org/wiki/Method_of_loci" title="Memory Palace - Wikipedia" target="_blank">wikipedia article</a> for more details)) </p>
<p>In my memory palace I was walking down the path towards the house where I grew up, and seeing a &#8216;<strong>S</strong>o<strong>RC</strong>erer/<strong>Src Port</strong>&#8216; battling with &#8216;Dick <strong>D</strong>a<strong>ST</strong>ardly and Mutley/<strong>Dst Port</strong>&#8216;, then walk into my mothers front hallway with a <strong>Sequence Number</strong> along the front hall, then my Grandfather sitting in a chair in the living room saying &#8220;<strong>ACK</strong>!&#8221; because the soccer is on the television and he's complaining about the <strong>Header Length</strong> &#8230; you get the idea - but yeah, you need to make your own memory palace.</p><p>Now that I have a complete image of this TCP packet in my head suddenly expressions like :</p><p><code>tcpdump -ni en1 tcp[13] == 18 and host 172.16.1.200 and port 80 </code></p><p>are way easier to understand and use - the <code>tcp[13]</code> part refers to the 13th Octet of the packet, which is the Flags octet, then the <code>18</code> part is a simple decimal representation of the binary flags, in the order they are in the diagram above - i.e the Flags are </p><p><code>CWR | ECE | URG | ACK | PSH | RST | SYN | FIN</code> </p><p>so in my example 18 refers to having both the ACK and SYN flags set - 00010010 which if you're used to dealing with netmasks math is quite an easy translation. My example, then, will only capture the first response packet from the server, as it would be the only part of the conversation to have both an ACK and SYN flag set. (I used a separate memory palace for the flags themselves)</p><p>To capture all SYN packets, including the ACK/SYN ones, you would use:</p><p><code>tcpdump -ni en1 &#039;tcp[13] == 18 or tcp[13] == 2&#039; and host 172.16.1.200 and port 80</code>.</p><p>Memory Palaces are pretty damn useful!</p><p>** Most Engineers are aware of TCP/IP Illustrated, however a lot of people I've spoken to aren't aware there was a <a href="http://www.amazon.com/TCP-Illustrated-Volume-Addison-Wesley-Professional/dp/0321336313/ref=pd_sim_b_1" title="TCP/IP Illustrated Vol 1 Edition 2" target="_blank">2nd Edition published in November of 2011, updated by a guy named Kevin R. Fall</a> - I would absolutely recommend it, an amazing book and especially with the updates, just seems an essential addition to any Engineer's library..</p>

</article>

    
        <article class="post">
    <header>
      <h2><a href='http://theb0ardside.com/puppetstagesandapt/'> Puppet stages and APT</a> </h2>
      <div class="post-meta">Tue, Apr 3, 2012</div>
    </header>
    <p><img src="http://www.stixrideshop.com/blog/wp-content/uploads/2012/03/gonz-3.bmp" alt="gonz -- for no reason except he&#039;s the MAN!" /></p><p>At work, our old code deployment strategy was basically a wrapper script doing an svn checkout and some symlinking. With our move to Puppet for config management, we also moved to using Apt packaging for our code deployment, tying them together with a line similar to :</p><p><code>class foo-export {<br />    package { &#039;foo-export&#039;: ensure => latest }<br />}</code></p><p>So that whenever we deploy a new version of a package to our apt-repo, it can then be installed with a:</p><p><code>puppet agent --test</code><br />(and with an initial dry-run using <code>--noop</code>)</p><p>( I should mention I manage our Puppet runs via our own distributed scripts, rather than having the nodes set up to check in every 30mins - when I'm doing so much work on our Puppet setup and config, I'd rather not having machines check in automatically in case the config is in a broken state )</p><p>Inevitably I would run the above Puppet command and it would not find any new packages, because &#8216;d'uh!', of course I still need to run an <code>apt-get update</code>.</p><p>I've been using Puppet stages for a while now, in order to group package installations in a broader sense rather than manually spelling out every dependency with a <code>require =></code> stanza, so it was a simple addition to add in a <code>pre</code> stage, and have the nodes run <code>apt-get update</code> before any runs.</p><p>In order to use stages, you need to first define them in your site.pp. By default every defined class runs under Stage[main], so you just need to add the new stages and define the running order. (full Puppet stage documentation is <a href="http://docs.puppetlabs.com/guides/language_guide.html" title="Puppet Stages" target="_blank">here</a>)</p><p>At the top of my site.pp file, I added a pre and post stage, then define the execution order via:</p><p><code>stage { [pre, post]: }<br />Stage[pre] -> Stage[main] -> Stage[post]</code></p><p>Then I created a class called apt-hupdate (sorry, i use stupid naming conventions!) in<br /><code>modules/apt-hupdate/manifests/init.pp</code></p><p>which contained:<br /><code>class apt-hupdate {</p><p>    exec { "aptHupdate":<br />        command => "/usr/bin/apt-get update",<br />    }<br />}</code></p><p>And finally, include that in your site.pp with:</p><p><code>class { apt-hupdate: stage => pre }</code></p><p>Now every time you do a Puppet run, <code>apt-get update</code> will be the first task run.</p>

</article>

    
        <article class="post">
    <header>
      <h2><a href='http://theb0ardside.com/vagrantandchefsetup/'> Vagrant and Chef setup</a> </h2>
      <div class="post-meta">Fri, Aug 5, 2011</div>
    </header>
    <p>I've been reading through ThoughtWorks' latest &#8216;<a href="http://www.thoughtworks.com/radar" title="radar" target="_blank">technology radar</a>&#8216; which led me to look up <a href="http://vagrantup.com/" title="Vagrant" target="_blank">Vagrant</a>, one of the tools they list as worth exploring.</p><p>Vagrant is a framework for building and deploying Virtual Machine environments, using Oracle VirtualBox for the actual VMs and utilizing Chef for configuration management.  </p><p>Watching through this intro video:</p><p>http://vimeo.com/9976342</p><p>i was quite intrigued as it is very similar to what i was looking to achieve earlier when i was <a href="http://www.theb0ardside.com/?p=22" title="Xen and Puppet" target="_blank">experimenting with installing Xen and configuring with Puppet.</a></p><p>So here's what I experienced during the setup of Vagrant on my Macbook - I decided to start with a simple Chef install to familiarise myself with Chef itself and it's own requirements CouchDB, RabbitMQ and Solr, mostly by following <a href="http://wiki.opscode.com/display/chef/Manual+Chef+Server+Configuration" title="Chef Manual Install OS X" target="_blank">these instructions</a> - </p><p><strong>-CHEF INSTALL-</strong></p><p><strong>sudo gem install chef<br />sudo gem install ohai<br /></strong></p><p>Chef uses couchDB as it's datastore, so we need to install it using the instructions <a href="http://wiki.apache.org/couchdb/Installing_on_OSX" title="CouchDB install OS X" target="_blank">here</a> </p><p><strong>brew install couchdb</strong></p><p>The instructions I list above also contains steps to install a couchDB user and set it up as a daemon. They didn't work for me, and after 30mins of troubleshooting, i gave up and went with the simpler option of running it under my own user - in production this will be running on a Linux server rather than my Macbook, so it seemed fair enough -</p><p><strong>cp /usr/local/Cellar/couchdb/1.1.0/Library/LaunchDaemons/org.apache.couchdb.plist ~/Library/LaunchAgents/</p><p>launchctl load -w ~/Library/LaunchAgents/org.apache.couchdb.plist</strong></p><p>Check its running okay by going to<br /><a href="http://127.0.0.1:5984/" title="Localhost" target="_blank">http://127.0.0.1:5984/</a></p><p>which should provide something akin to :<br /><strong>{&#8220;couchdb&#8221;:&#8221;Welcome&#8221;,&#8221;version&#8221;:&#8221;1.1.0&#8243;}</strong></p><p><strong>- INSTALL RABBITMQ -</strong></p><p><strong>brew install rabbitmq<br />/usr/local/sbin/rabbitmq-server -detached</p><p>sudo rabbitmqctl add_vhost /chef<br />sudo rabbitmqctl add_user chef testing<br />sudo rabbitmqctl set_permissions -p /chef chef &#8220;.*&#8221; &#8220;.*&#8221; &#8220;.*&#8221;<br /></strong></p><p>Ok, Gettin' back to my mission, break out the whipped cream and the cherries, then I go through all the fly positions - oh, wrong mission! </p><p>Ok..</p><p><strong>brew install gecode<br />brew install solr</p><p>sudo gem install chef-server chef-server-api chef-server chef-solr<br />sudo gem install chef-server-webui<br />sudo chef-solr-installer<br /></strong></p><p>Setup a conf file -<br /><strong>sudo mkdir /etc/chef<br />sudo vi /etc/chef/server.rb</strong> - paste in the example from:</p><p><a href="http://wiki.opscode.com/display/chef/Manual+Chef+Server+Configuration" title="chef conf" target="_blank">http://wiki.opscode.com/display/chef/Manual+Chef+Server+Configuration</a> - making the appropriate changes for your FQDN</p><p>At this point, the above instructions ask you to start the indexer however the instructions haven't been updated to reflect changes to Chef version 0.10.2 in which chef-solr-indexer has been replaced with chef-expander</p><p>So, instead of running:<br /><strong>sudo chef-solr-indexer </strong></p><p>you instead need to run:<br /><strong>sudo chef-expander -n1 -d<br /></strong></p><p>Next i tried<br /><strong>sudo chef-solr</strong></p><p>which ran into<br /><em>&#8220;`configure_chef': uninitialized constant Chef::Application::SocketError (NameError)&#8221;</em></p><p>i had to create an <strong>/etc/chef/solr.rb</strong> file and simply add this to the file:</p><p><strong>require &#8216;socket'</strong> </p><p>startup now worked -<br />if you want to daemonize it, use:</p><p><strong>sudo chef-solr -d</strong></p><p>Next start Chef Server with:<br /><strong>sudo chef-server -N -e production -d</strong></p><p>and finally:<br /><strong>sudo chef-server-webui -p 4040 -e production</strong></p><p>Now you should be up and running - you need to configure the command client &#8216;Knife' follwing the instructions <a href="http://wiki.opscode.com/display/chef/Manual+Chef+Server+Configuration" title="Knife setup" target="_blank">here</a> - under the section &#8216;<strong>Configure the Command Line Client</strong>&#8216;</p><p><strong>mkdir -p ~/.chef<br />sudo cp /etc/chef/validation.pem /etc/chef/webui.pem ~/.chef<br />sudo chown -R $USER ~/.chef</p><p>knife configure -i</strong></p><p>(follow the instructions at the link - you only need to change the location of the two pem files you copied above)</p><p>Ok, so hopefully you're at the same place as me with this all working at least as far as being able to log into CouchDB, and verifying that Chef/Knife are both working.</p><p><strong>- VAGRANT SETUP -</strong></p><p>Now, onward with the original task of Vagrant setup&#8230;<br />Have a read over the <a href="http://vagrantup.com/docs/getting-started/index.html " title="Vagrant Getting Started" target="_blank">getting started guide:</a></p><p>Install VirtualBox - download from <a href="http://www.virtualbox.org/wiki/Downloads" title="VirtualBox" target="_blank">http://www.virtualbox.org/wiki/Downloads</a></p><p>Run the installer, which should all work quite easily. Next..</p><p><strong>gem install vagrant</p><p>mkdir vagrant_guide<br />cd vagrant_guide/<br />vagrant init</strong></p><p>this creates the base Vagrantfile, which the documentation compares to a Makefile, basically a reference file for the project to work with.</p><p>Setup our first VM -<br /><strong>vagrant box add lucid32 http://files.vagrantup.com/lucid32.box</strong></p><p>This is downloaded and saved in ~/.vagrant.d/boxes/ </p><p>edit the Vagrantfile which was created and change the &#8220;box&#8221; entry to be &#8220;lucid32&#8243;, the name of the file we just saved. </p><p>Bring it online with:<br /><strong>vagrant up</strong></p><p>then ssh into with<br /><strong>vargrant ssh</strong></p><p>Ace, that worked quite easily. After a little digging around, I  logged out and tore the machine down again with<br /><strong>vagrant destroy</strong></p><p><strong>- TYING IT ALL TOGETHER -</strong><br />Now we need to connect our Vagrant install with our Chef server</p><p>First, clone the Chef repository with:<br /><strong>git clone git://github.com/opscode/chef-repo.git </strong></p><p>add this dir to your <strong>~/.chef/knife.rb</strong> file<br />i.e<br /><strong>cookbook_path           ["/Users/thorstensideboard/chef-repo/cookbooks"]</strong></p><p>Download the Vagrant cookbook they use in their examples -</p><p><strong>wget http://files.vagrantup.com/getting_started/cookbooks.tar.gz<br />tar xzvf cookbooks.tar.gz<br />mv cookbooks/* chef-repo/cookbooks/<br /></strong></p><p>Add it to our Chef server using Knife:<br /><strong>knife cookbook upload -a</strong><br />(knife uses the cookbook_path we setup above)</p><p>If you browse to your localhost at<br /><strong>http://sbd-ioda.local:4040/cookbooks/</strong><br />you should see the three new cookbooks which have been added.</p><p>Now to edit Vagrantfile and add your Chef details:<br /><code><br />Vagrant::Config.run do |config|</p><p>    config.vm.box = "lucid32"</p><p>    config.vm.provision :chef_client do |chef|</p><p>    chef.chef_server_url = "http://SBD-IODA.local:4000"<br />    chef.validation_key_path = "/Users/thorsten/.chef/validation.pem"<br />    chef.add_recipe("vagrant_main")<br />    chef.add_recipe("apt")<br />    chef.add_recipe("apache2")</p><p>    end<br />end<br /></code></p><p>I tried to load this up with<br /><strong>vagrant up</strong><br />however received:</p><blockquote><p>&#8220;[default] [Fri, 05 Aug 2011 09:27:07 -0700] INFO: *** Chef 0.10.2 ***<br />: stdout<br />[default] [Fri, 05 Aug 2011 09:27:07 -0700] INFO: Client key /etc/chef/client.pem is not present - registering<br />: stdout<br />[default] [Fri, 05 Aug 2011 09:27:28 -0700] FATAL: Stacktrace dumped to /srv/chef/file_store/chef-stacktrace.out<br />: stdout<br />[default] [Fri, 05 Aug 2011 09:27:28 -0700] FATAL: SocketError: Error connecting to http://SBD-IODA.local:4000/clients - getaddrinfo: Name or service not known&#8221;</p></blockquote><p>I figured this was a networking issue, and yeah, within the VM it has no idea of my Macbook's local hostname, which i fixed by editing its /etc/hosts file and manually adding it.</p><p>Upon issuing a<br /><strong>vagrant reload</strong>, boom! you can see the Vagrant host following the recipes and loading up a bunch of things including apache2</p><p>However at this point, you can still only access it's webserver from within the VM, so in order to access it from our own desktop browser, we can add the following line to the Vagrantfile:<br /><strong>config.vm.forward_port(&#8220;web&#8221;, 80, 8080)</strong></p><p>After another reload, you should now be able to connect to localhost:8080 and access your new VM's apache host.</p><p>In order to use this setup in any sort of dev environment will still need a good deal more work, but for the moment, this should be enough to get you up and running and able to explore both Vagrant and Chef. </p>

</article>

    
  </div>
</section>

      <script src="/static/js/jquery.js"></script>
      <script src="/static/js/bootstrap.min.js"></script>
      <script src="/static/js/mousetrap.min.js"></script>
      <script src="/static/js/b0ardside.js"></script>
      </div>
      </div>
      <div id="footer"></div>
  </body>

</html>

